var d=t=>{throw TypeError(t)};var u=(t,e,i)=>e.has(t)||d("Cannot "+i);var l=(t,e,i)=>e.has(t)?d("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i);var _=(t,e,i)=>(u(t,e,"access private method"),i);typeof window.__JUCE__<"u"&&typeof window.__JUCE__.getAndroidUserScripts<"u"&&typeof window.inAndroidUserScriptEval>"u"&&(window.inAndroidUserScriptEval=!0,eval(window.__JUCE__.getAndroidUserScripts()),delete window.inAndroidUserScriptEval);{typeof window.__JUCE__>"u"&&(console.warn("The 'window.__JUCE__' object is undefined. Native integration features will not work. Defining a placeholder 'window.__JUCE__' object."),window.__JUCE__={postMessage:function(){}}),typeof window.__JUCE__.initialisationData>"u"&&(window.__JUCE__.initialisationData={__juce__platform:[],__juce__functions:[],__juce__registeredGlobalEventIds:[],__juce__sliders:[],__juce__toggles:[],__juce__comboBoxes:[]});class t{constructor(){this.listeners=new Map,this.listenerId=0}addListener(n){const r=this.listenerId++;return this.listeners.set(r,n),r}removeListener(n){this.listeners.has(n)&&this.listeners.delete(n)}callListeners(n){for(const[,r]of this.listeners)r(n)}}class e{constructor(){this.eventListeners=new Map}addEventListener(n,r){this.eventListeners.has(n)||this.eventListeners.set(n,new t);const o=this.eventListeners.get(n).addListener(r);return[n,o]}removeEventListener([n,r]){this.eventListeners.has(n)&&this.eventListeners.get(n).removeListener(r)}emitEvent(n,r){this.eventListeners.has(n)&&this.eventListeners.get(n).callListeners(r)}}class i{constructor(){this.listeners=new e}addEventListener(n,r){return this.listeners.addEventListener(n,r)}removeEventListener([n,r]){this.listeners.removeEventListener(n,r)}emitEvent(n,r){window.__JUCE__.postMessage(JSON.stringify({eventId:n,payload:r}))}emitByBackend(n,r){this.listeners.emitEvent(n,JSON.parse(r))}}typeof window.__JUCE__.backend>"u"&&(window.__JUCE__.backend=new i)}class PromiseHandler{constructor(){this.lastPromiseId=0,this.promises=new Map,window.__JUCE__.backend.addEventListener("__juce__complete",({promiseId:e,result:i})=>{this.promises.has(e)&&(this.promises.get(e).resolve(i),this.promises.delete(e))})}createPromise(){const e=this.lastPromiseId++,i=new Promise((s,n)=>{this.promises.set(e,{resolve:s,reject:n})});return[e,i]}}const promiseHandler=new PromiseHandler;function getNativeFunction(t){return window.__JUCE__.initialisationData.__juce__functions.includes(t)||console.warn(`Creating native function binding for '${t}', which is unknown to the backend`),function(){const[i,s]=promiseHandler.createPromise();return window.__JUCE__.backend.emitEvent("__juce__invoke",{name:t,params:Array.prototype.slice.call(arguments),resultId:i}),s}}class ListenerList{constructor(){this.listeners=new Map,this.listenerId=0}addListener(e){const i=this.listenerId++;return this.listeners.set(i,e),i}removeListener(e){this.listeners.has(e)&&this.listeners.delete(e)}callListeners(e){for(const[,i]of this.listeners)i(e)}}const BasicControl_valueChangedEventId="valueChanged",BasicControl_propertiesChangedId="propertiesChanged",SliderControl_sliderDragStartedEventId="sliderDragStarted",SliderControl_sliderDragEndedEventId="sliderDragEnded";class SliderState{constructor(e){window.__JUCE__.initialisationData.__juce__sliders.includes(e)||console.warn("Creating SliderState for '"+e+"', which is unknown to the backend"),this.name=e,this.identifier="__juce__slider"+this.name,this.scaledValue=0,this.properties={start:0,end:1,skew:1,name:"",label:"",numSteps:100,interval:0,parameterIndex:-1},this.valueChangedEvent=new ListenerList,this.propertiesChangedEvent=new ListenerList,window.__JUCE__.backend.addEventListener(this.identifier,i=>this.handleEvent(i)),window.__JUCE__.backend.emitEvent(this.identifier,{eventType:"requestInitialUpdate"})}setNormalisedValue(e){this.scaledValue=this.snapToLegalValue(this.normalisedToScaledValue(e)),window.__JUCE__.backend.emitEvent(this.identifier,{eventType:BasicControl_valueChangedEventId,value:this.scaledValue})}sliderDragStarted(){window.__JUCE__.backend.emitEvent(this.identifier,{eventType:SliderControl_sliderDragStartedEventId})}sliderDragEnded(){window.__JUCE__.backend.emitEvent(this.identifier,{eventType:SliderControl_sliderDragEndedEventId})}handleEvent(e){if(e.eventType==BasicControl_valueChangedEventId&&(this.scaledValue=e.value,this.valueChangedEvent.callListeners()),e.eventType==BasicControl_propertiesChangedId){let{eventType:i,...s}=e;this.properties=s,this.propertiesChangedEvent.callListeners()}}getScaledValue(){return this.scaledValue}getNormalisedValue(){return Math.pow((this.scaledValue-this.properties.start)/(this.properties.end-this.properties.start),this.properties.skew)}normalisedToScaledValue(e){return Math.pow(e,1/this.properties.skew)*(this.properties.end-this.properties.start)+this.properties.start}snapToLegalValue(e){const i=this.properties.interval;if(i==0)return e;const s=this.properties.start;return((r,o=0,h=1)=>Math.max(o,Math.min(h,r)))(s+i*Math.floor((e-s)/i+.5),this.properties.start,this.properties.end)}}const sliderStates=new Map;for(const t of window.__JUCE__.initialisationData.__juce__sliders)sliderStates.set(t,new SliderState(t));function getSliderState(t){return sliderStates.has(t)||sliderStates.set(t,new SliderState(t)),sliderStates.get(t)}class ToggleState{constructor(e){window.__JUCE__.initialisationData.__juce__toggles.includes(e)||console.warn("Creating ToggleState for '"+e+"', which is unknown to the backend"),this.name=e,this.identifier="__juce__toggle"+this.name,this.value=!1,this.properties={name:"",parameterIndex:-1},this.valueChangedEvent=new ListenerList,this.propertiesChangedEvent=new ListenerList,window.__JUCE__.backend.addEventListener(this.identifier,i=>this.handleEvent(i)),window.__JUCE__.backend.emitEvent(this.identifier,{eventType:"requestInitialUpdate"})}getValue(){return this.value}setValue(e){this.value=e,window.__JUCE__.backend.emitEvent(this.identifier,{eventType:BasicControl_valueChangedEventId,value:this.value})}handleEvent(e){if(e.eventType==BasicControl_valueChangedEventId&&(this.value=e.value,this.valueChangedEvent.callListeners()),e.eventType==BasicControl_propertiesChangedId){let{eventType:i,...s}=e;this.properties=s,this.propertiesChangedEvent.callListeners()}}}const toggleStates=new Map;for(const t of window.__JUCE__.initialisationData.__juce__toggles)toggleStates.set(t,new ToggleState(t));function getToggleState(t){return toggleStates.has(t)||toggleStates.set(t,new ToggleState(t)),toggleStates.get(t)}class ComboBoxState{constructor(e){window.__JUCE__.initialisationData.__juce__comboBoxes.includes(e)||console.warn("Creating ComboBoxState for '"+e+"', which is unknown to the backend"),this.name=e,this.identifier="__juce__comboBox"+this.name,this.value=0,this.properties={name:"",parameterIndex:-1,choices:[]},this.valueChangedEvent=new ListenerList,this.propertiesChangedEvent=new ListenerList,window.__JUCE__.backend.addEventListener(this.identifier,i=>this.handleEvent(i)),window.__JUCE__.backend.emitEvent(this.identifier,{eventType:"requestInitialUpdate"})}getChoiceIndex(){return Math.round(this.value*(this.properties.choices.length-1))}setChoiceIndex(e){const i=this.properties.choices.length;this.value=i>1?e/(i-1):0,window.__JUCE__.backend.emitEvent(this.identifier,{eventType:BasicControl_valueChangedEventId,value:this.value})}handleEvent(e){if(e.eventType==BasicControl_valueChangedEventId&&(this.value=e.value,this.valueChangedEvent.callListeners()),e.eventType==BasicControl_propertiesChangedId){let{eventType:i,...s}=e;this.properties=s,this.propertiesChangedEvent.callListeners()}}}const comboBoxStates=new Map;for(const t of window.__JUCE__.initialisationData.__juce__comboBoxes)comboBoxStates.set(t,new ComboBoxState(t));function getComboBoxState(t){return comboBoxStates.has(t)||comboBoxStates.set(t,new ComboBoxState(t)),comboBoxStates.get(t)}function getBackendResourceAddress(t){const e=window.__JUCE__.initialisationData.__juce__platform.length>0?window.__JUCE__.initialisationData.__juce__platform[0]:"";return e=="windows"||e=="android"?"https://juce.backend/"+t:e=="macos"||e=="ios"||e=="linux"?"juce://juce.backend/"+t:(console.warn("getBackendResourceAddress() called, but no JUCE native backend is detected."),t)}var a,c;class ControlParameterIndexUpdater{constructor(e){l(this,a);this.controlParameterIndexAnnotation=e,this.lastElement=null,this.lastControlParameterIndex=null}handleMouseMove(e){const i=document.elementFromPoint(e.clientX,e.clientY);if(i===this.lastElement)return;this.lastElement=i;let s=-1;i!==null&&(s=_(this,a,c).call(this,i)),s!==this.lastControlParameterIndex&&(this.lastControlParameterIndex=s,window.__JUCE__.backend.emitEvent("__juce__controlParameterIndexChanged",s))}}a=new WeakSet,c=function(e){const i=s=>s!==null&&s!==document.documentElement;for(;i(e);){if(e.hasAttribute(this.controlParameterIndexAnnotation))return e.getAttribute(this.controlParameterIndexAnnotation);e=e.parentElement}return-1};export{ControlParameterIndexUpdater,getBackendResourceAddress,getComboBoxState,getNativeFunction,getSliderState,getToggleState};
